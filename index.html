<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Beaneater by Nico-Taing</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">Beaneater</h1>
        <p class="header">Best way to consume beanstalkd</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/Nico-Taing/beaneater/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/Nico-Taing/beaneater/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/Nico-Taing/beaneater">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/Nico-Taing">Nico-Taing</a></p>


      </header>
      <section>
        <h1>Beaneater</h1>

<p><a href="http://kr.github.com/beanstalkd/">Beaneater</a> is a simple, fast work queue. Its interface is generic, but was
originally designed for reducing the latency of page views in high-volume web
applications by running time-consuming tasks asynchronously. 
Read the <a href="https://github.com/kr/beanstalkd/blob/master/doc/protocol.md">beanstalk protocol</a> for more detail.</p>

<h2>Why Beanstalk?</h2>

<p>Illya has an excellent blog post
<a href="http://www.igvita.com/2010/05/20/scalable-work-queues-with-beanstalk/">Scalable Work Queues with Beanstalk</a> and
Adam Wiggins posted <a href="http://adam.heroku.com/past/2010/4/24/beanstalk_a_simple_and_fast_queueing_backend/">an excellent comparison</a>.</p>

<p>You will quickly see that <strong>beanstalkd</strong> is an underrated but incredible project that is extremely well-suited as a job queue.
Significantly better suited for this task than Redis or a database. Beanstalk is a simple,
and a very fast work queue service rolled into a single binary - it is the memcached of work queues.
Originally built to power the backend for the 'Causes' Facebook app, it is a mature and production ready open source project.
<a href="http://www.postrank.com">PostRank</a> uses beanstalk to reliably process millions of jobs a day.</p>

<p>A single instance of Beanstalk is perfectly capable of handling thousands of jobs a second (or more, depending on your job size)
because it is an in-memory, event-driven system. Powered by libevent under the hood,
it requires zero setup (launch and forget, à la memcached), optional log based persistence, an easily parsed ASCII protocol,
and a rich set of tools for job management that go well beyond a simple FIFO work queue.</p>

<p>Beanstalk supports the following features natively, out of the box, without any questions asked:</p>

<ul>
<li>
<strong>Parallel Queues</strong> - Supports multiple work queues created on demand.</li>
<li>
<strong>Reliable</strong> - Beanstalk’s reserve, work, delete cycle ensures reliable processing.</li>
<li>
<strong>Scheduling</strong> - Delay enqueuing jobs by a specified interval to schedule processing later.</li>
<li>
<strong>Fast</strong> - Processes thousands of jobs per second; <strong>significantly</strong> <a href="http://adam.heroku.com/past/2010/4/24/beanstalk_a_simple_and_fast_queueing_backend">faster than alternatives</a>.</li>
<li>
<strong>Priorities</strong> - Specify priority so important jobs can be processed quickly.</li>
<li>
<strong>Persistence</strong> - Jobs are stored in memory for speed, but logged to disk for safe keeping.</li>
<li>
<strong>Federation</strong> - Horizontal scalability provided through federation by the client.</li>
<li>
<strong>Buried jobs</strong> - Bury any job which causes an error for later debugging and inspection.</li>
</ul><p>Keep in mind that these features are supported out of the box with beanstalk and require no special code within this gem to support.
In the end, <strong>beanstalk is the ideal job queue</strong> while also being ridiculously easy to install and setup.</p>

<h2>Installation</h2>

<p>Install beanstalkd:</p>

<p>Mac OS</p>

<pre><code>brew update
brew install beanstalkd
beanstalkd -p 11300
</code></pre>

<p>Ubuntu</p>

<pre><code>apt-get install beanstalkd
beanstalkd -p 11300
</code></pre>

<p>Install beaneater as a gem:</p>

<pre><code>gem install beaneater
</code></pre>

<p>or add this to your Gemfile:</p>

<div class="highlight"><pre><span class="c1"># Gemfile</span>
<span class="n">gem</span> <span class="s1">'beaneater'</span>
</pre></div>

<p>and run <code>bundle install</code> to install the dependency.</p>

<h2>Usage</h2>

<h3>Connection</h3>

<p>To interact with a beanstalk queue, first establish a connection by providing a set of addresses:</p>

<div class="highlight"><pre><span class="vi">@beanstalk</span> <span class="o">=</span> <span class="no">Beaneater</span><span class="o">::</span><span class="no">Pool</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="o">[</span><span class="s1">'10.0.1.5:11300'</span><span class="o">]</span><span class="p">)</span>
</pre></div>

<p>You can conversely close and dispose of a pool at any time with:</p>

<div class="highlight"><pre><span class="vi">@beanstalk</span><span class="o">.</span><span class="n">close</span>
</pre></div>

<h3>Tubes</h3>

<p>Beanstalkd has one or more tubes which can contain any number of jobs. 
Jobs can be inserted (put) into the used tube and pulled out (reserved) from watched tubes. 
Each tube consists of a <em>ready</em>, <em>delayed</em>, and <em>buried</em> queue for jobs. </p>

<p>When a client connects, its watch list is initially just the tube named <code>default</code>.<br>
Tube names are at most 200 bytes. It specifies the tube to use. If the tube does not exist, it will be automatically created.</p>

<p>To interact with a tube, first <code>find</code> the tube:</p>

<div class="highlight"><pre><span class="vi">@tube</span> <span class="o">=</span> <span class="vi">@beanstalk</span><span class="o">.</span><span class="n">tubes</span><span class="o">.</span><span class="n">find</span> <span class="s2">"some-tube-here"</span>
<span class="c1"># =&gt; &lt;Tube name='some-tube-here'&gt;</span>
</pre></div>

<p>To reserve jobs from beanstalk, you will need to 'watch' certain tubes:</p>

<div class="highlight"><pre><span class="c1"># Watch only the tubes listed below (!)</span>
<span class="vi">@beanstalk</span><span class="o">.</span><span class="n">tubes</span><span class="o">.</span><span class="n">watch!</span><span class="p">(</span><span class="s1">'some-tube'</span><span class="p">)</span>
<span class="c1"># Append tubes to existing set of watched tubes</span>
<span class="vi">@beanstalk</span><span class="o">.</span><span class="n">tubes</span><span class="o">.</span><span class="n">watch</span><span class="p">(</span><span class="s1">'another-tube'</span><span class="p">)</span>
<span class="c1"># You can also ignore tubes that have been watched previously</span>
<span class="vi">@beanstalk</span><span class="o">.</span><span class="n">ignore</span><span class="p">(</span><span class="s1">'some-tube'</span><span class="p">)</span>
</pre></div>

<p>You can easily get a list of all, used or watched tubes:</p>

<div class="highlight"><pre><span class="c1"># The list-tubes command returns a list of all existing tubes</span>
<span class="vi">@beanstalk</span><span class="o">.</span><span class="n">tubes</span><span class="o">.</span><span class="n">all</span>
<span class="c1"># =&gt; [&lt;Tube name='foo'&gt;, &lt;Tube name='bar'&gt;]</span>

<span class="c1"># Returns the tube currently being used by the client (for insertion)</span>
<span class="vi">@beanstalk</span><span class="o">.</span><span class="n">tubes</span><span class="o">.</span><span class="n">used</span>
<span class="c1"># =&gt; &lt;Tube name='bar'&gt;</span>

<span class="c1"># Returns a list tubes currently being watched by the client (for consumption)</span>
<span class="vi">@beanstalk</span><span class="o">.</span><span class="n">tubes</span><span class="o">.</span><span class="n">watched</span>
<span class="c1"># =&gt; [&lt;Tube name='foo'&gt;]</span>
</pre></div>

<p>You can also temporarily 'pause' the execution of a tube by specifying the time:</p>

<div class="highlight"><pre><span class="n">tube</span> <span class="o">=</span> <span class="vi">@beanstalk</span><span class="o">.</span><span class="n">tubes</span><span class="o">[</span><span class="s2">"some-tube-here"</span><span class="o">]</span>
<span class="n">tube</span><span class="o">.</span><span class="n">pause</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># pauses tube for 3 seconds</span>
</pre></div>

<p>or even clear the tube of all jobs:</p>

<div class="highlight"><pre><span class="n">tube</span> <span class="o">=</span> <span class="vi">@beanstalk</span><span class="o">.</span><span class="n">tubes</span><span class="o">[</span><span class="s2">"some-tube-here"</span><span class="o">]</span>
<span class="n">tube</span><span class="o">.</span><span class="n">clear</span> <span class="c1"># tube will now be empty</span>
</pre></div>

<p>In summary, each beanstalk client manages two separate concerns: which tube newly created jobs are put into, 
and which tube(s) jobs are reserved from. Accordingly, there are two separate sets of functions for these concerns:</p>

<ul>
<li>
<strong>use</strong> and <strong>using</strong> affect where 'put' places jobs</li>
<li>
<strong>watch</strong> and <strong>watching</strong> control where reserve takes jobs from</li>
</ul><p>Note that these concerns are fully orthogonal: for example, when you 'use' a tube, it is not automatically 'watched'. 
Neither does 'watching' a tube affect the tube you are 'using'.</p>

<h3>Jobs</h3>

<p>A job in beanstalk gets inserted by a client and includes the 'body' and job metadata.
Each job is enqueued into a tube and later reserved and processed. Here is a picture of the typical job lifecycle:</p>

<pre><code>   put            reserve               delete
  -----&gt; [READY] ---------&gt; [RESERVED] --------&gt; *poof*
</code></pre>

<p>A job at any given time is in one of three states: <strong>ready</strong>, <strong>delayed</strong>, or <strong>buried</strong>:</p>

<ul>
<li>A <strong>ready</strong> job is waiting to be 'reserved' and processed after being 'put' onto a tube.</li>
<li>A <strong>delayed</strong> job is waiting to become ready after the specified delay.</li>
<li>A <strong>buried</strong> job has been reserved and buried, will not be reprocessed and is isolated for later use.</li>
</ul><p>In addition, there are several actions that can be performed on a given job:</p>

<ul>
<li>You can <strong>reserve</strong> which locks a job from the ready queue for processing.</li>
<li>You can <strong>touch</strong> which extends the time before a job is autoreleased back to ready.</li>
<li>You can <strong>release</strong> which places a reserved job back onto the ready queue.</li>
<li>You can <strong>delete</strong> which removes a job from beanstalk. </li>
<li>You can <strong>bury</strong> which places a reserved job into the buried state.</li>
<li>You can <strong>kick</strong> which places a buried job from the buried queue back to ready.</li>
</ul><p>You can insert a job onto a beanstalk tube using the <code>put</code> command:</p>

<div class="highlight"><pre><span class="vi">@tube</span><span class="o">.</span><span class="n">put</span> <span class="s2">"job-data-here"</span>
</pre></div>

<p>Each job has various metadata associated such as <code>priority</code>, <code>delay</code>, and <code>ttr</code> which can be 
specified as part of the <code>put</code> command:</p>

<div class="highlight"><pre><span class="c1"># defaults are priority 0, delay of 0 and ttr of 120 seconds</span>
<span class="vi">@tube</span><span class="o">.</span><span class="n">put</span> <span class="s2">"job-data-here"</span><span class="p">,</span> <span class="ss">:pri</span> <span class="o">=&gt;</span> <span class="mi">1000</span><span class="p">,</span> <span class="ss">:delay</span> <span class="o">=&gt;</span> <span class="mi">50</span><span class="p">,</span> <span class="ss">:ttr</span> <span class="o">=&gt;</span> <span class="mi">200</span>
</pre></div>

<p>The <code>priority</code> argument is an integer &lt; 2**32. Jobs with a smaller priority take precedence over jobs with larger priorities. 
The <code>delay</code> argument is an integer number of seconds to wait before putting the job in the ready queue.
The <code>ttr</code> argument is the time to run -- is an integer number of seconds to allow a worker to run this job. </p>

<h3>Processing Jobs (Manually)</h3>

<p>In order to process jobs, the client should first specify the intended tubes to be watched. If not specified, 
this will default to watching just the <code>default</code> tube. </p>

<div class="highlight"><pre><span class="vi">@beanstalk</span> <span class="o">=</span> <span class="no">Beaneater</span><span class="o">::</span><span class="no">Connection</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="o">[</span><span class="s1">'10.0.1.5:11300'</span><span class="o">]</span><span class="p">)</span>
<span class="vi">@beanstalk</span><span class="o">.</span><span class="n">tubes</span><span class="o">.</span><span class="n">watch!</span><span class="p">(</span><span class="s1">'tube-name'</span><span class="p">,</span> <span class="s1">'other-tube'</span><span class="p">)</span>
</pre></div>

<p>Next you can use the <code>reserve</code> command which will return the first available job within the watched tubes:</p>

<div class="highlight"><pre><span class="n">job</span> <span class="o">=</span> <span class="vi">@beanstalk</span><span class="o">.</span><span class="n">tubes</span><span class="o">.</span><span class="n">reserve</span>
<span class="c1"># =&gt; &lt;Beaneater::Job id=5 body="foo"&gt;</span>
<span class="nb">puts</span> <span class="n">job</span><span class="o">.</span><span class="n">body</span>
<span class="c1"># prints 'job-data-here'</span>
<span class="nb">print</span> <span class="n">job</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">state</span> <span class="c1"># =&gt; 'reserved'</span>
</pre></div>

<p>By default, reserve will wait indefinitely for the next job. If you want to specify a timeout,
simply pass that in seconds into the command:</p>

<div class="highlight"><pre><span class="n">job</span> <span class="o">=</span> <span class="vi">@beanstalk</span><span class="o">.</span><span class="n">tubes</span><span class="o">.</span><span class="n">reserve</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># wait 5 secs for a job, then return</span>
<span class="c1"># =&gt; &lt;Beaneater::Job id=5 body="foo"&gt;</span>
</pre></div>

<p>You can 'release' a reserved job back onto the ready queue to retry later:</p>

<div class="highlight"><pre><span class="n">job</span> <span class="o">=</span> <span class="vi">@beanstalk</span><span class="o">.</span><span class="n">tubes</span><span class="o">.</span><span class="n">reserve</span>
<span class="c1"># ...job has ephemeral fail...</span>
<span class="n">job</span><span class="o">.</span><span class="n">release</span> <span class="ss">:delay</span> <span class="o">=&gt;</span> <span class="mi">5</span>
<span class="nb">print</span> <span class="n">job</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">state</span> <span class="c1"># =&gt; 'delayed'</span>
</pre></div>

<p>You can also 'delete' jobs that are finished:</p>

<div class="highlight"><pre><span class="n">job</span> <span class="o">=</span> <span class="vi">@beanstalk</span><span class="o">.</span><span class="n">tubes</span><span class="o">.</span><span class="n">reserve</span>
<span class="n">job</span><span class="o">.</span><span class="n">touch</span> <span class="c1"># extends ttr for job</span>
<span class="c1"># ...process job...</span>
<span class="n">job</span><span class="o">.</span><span class="n">delete</span>
</pre></div>

<p>Beanstalk jobs can also be buried if they fail, rather than being deleted:</p>

<div class="highlight"><pre><span class="n">job</span> <span class="o">=</span> <span class="vi">@beanstalk</span><span class="o">.</span><span class="n">tubes</span><span class="o">.</span><span class="n">reserve</span>
<span class="c1"># ...job fails...</span>
<span class="n">job</span><span class="o">.</span><span class="n">bury</span>
<span class="nb">print</span> <span class="n">job</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">state</span> <span class="c1"># =&gt; 'buried'</span>
</pre></div>

<p>Burying a job means that the job is pulled out of the queue into a special 'holding' area for later inspection or reuse.
To reanimate this job later, you can 'kick' buried jobs back into being ready:</p>

<div class="highlight"><pre><span class="vi">@beanstalk</span><span class="o">.</span><span class="n">tubes</span><span class="o">[</span><span class="s1">'some-tube'</span><span class="o">].</span><span class="n">kick</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

<p>This kicks 3 buried jobs for 'some-tube' back into the 'ready' state. Jobs can also be
inspected using the 'peek' commands. To find and peek at a particular job based on the id:</p>

<div class="highlight"><pre><span class="vi">@beanstalk</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="c1"># =&gt; &lt;Beaneater::Job id=123 body="foo"&gt;</span>
</pre></div>

<p>or you can peek at jobs within a tube:</p>

<div class="highlight"><pre><span class="vi">@tube</span> <span class="o">=</span> <span class="vi">@beanstalk</span><span class="o">.</span><span class="n">tubes</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'foo'</span><span class="p">)</span>
<span class="vi">@tube</span><span class="o">.</span><span class="n">peek</span><span class="p">(</span><span class="ss">:ready</span><span class="p">)</span>
<span class="c1"># =&gt; &lt;Beaneater::Job id=123 body="ready"&gt;</span>
<span class="vi">@tube</span><span class="o">.</span><span class="n">peek</span><span class="p">(</span><span class="ss">:buried</span><span class="p">)</span>
<span class="c1"># =&gt; &lt;Beaneater::Job id=456 body="buried"&gt;</span>
<span class="vi">@tube</span><span class="o">.</span><span class="n">peek</span><span class="p">(</span><span class="ss">:delayed</span><span class="p">)</span>
<span class="c1"># =&gt; &lt;Beaneater::Job id=789 body="delayed"&gt;</span>
</pre></div>

<p>When dealing with jobs there are a few other useful commands available:</p>

<div class="highlight"><pre><span class="n">job</span> <span class="o">=</span> <span class="vi">@beanstalk</span><span class="o">.</span><span class="n">tubes</span><span class="o">.</span><span class="n">reserve</span>
<span class="nb">print</span> <span class="n">job</span><span class="o">.</span><span class="n">tube</span>      <span class="c1"># =&gt; "some-tube-name"</span>
<span class="nb">print</span> <span class="n">job</span><span class="o">.</span><span class="n">reserved?</span> <span class="c1"># =&gt; true</span>
<span class="nb">print</span> <span class="n">job</span><span class="o">.</span><span class="n">exists?</span>   <span class="c1"># =&gt; true</span>
<span class="n">job</span><span class="o">.</span><span class="n">delete</span>
<span class="nb">print</span> <span class="n">job</span><span class="o">.</span><span class="n">exists?</span>   <span class="c1"># =&gt; false</span>
</pre></div>

<h3>Processing Jobs (Automatically)</h3>

<p>Instead of using <code>watch</code> and <code>reserve</code>, you can also use the higher level <code>register</code> and <code>process</code> methods to
process jobs. First you can 'register' how to handle jobs from various tubes:</p>

<div class="highlight"><pre><span class="vi">@beanstalk</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s1">'some-tube-name'</span><span class="p">,</span> <span class="ss">:retry_on</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="no">SomeCustomException</span><span class="o">]</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">job</span><span class="o">|</span>
  <span class="n">do_something</span><span class="p">(</span><span class="n">job</span><span class="p">)</span>
<span class="k">end</span>

<span class="vi">@beanstalk</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s1">'some-other-name'</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">job</span><span class="o">|</span>
  <span class="n">do_something_else</span><span class="p">(</span><span class="n">job</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>

<p>Once you have registered the handlers for known tubes, calling <code>process!</code> will begin a
loop processing jobs as defined by the registered processor blocks:</p>

<div class="highlight"><pre><span class="vi">@beanstalk</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">process!</span>
</pre></div>

<p>Processing runs the following steps:</p>

<ol>
<li>Watch all registered tubes</li>
<li>Reserve the next job</li>
<li>Once job is reserved, invoke the registered handler based on the tube name</li>
<li>If no exceptions occur, delete the job (success)</li>
<li>If 'retry_on' exceptions occur, call 'release' (retry)</li>
<li>If other exception occurs, call 'bury' (error)</li>
<li>Repeat steps 2-5</li>
</ol><p>The <code>process</code> command is ideally suited for a beanstalk job processing daemon.</p>

<h3>Handling Errors</h3>

<p>While using Beaneater, certain errors may be encountered. Errors are encountered when
a command is sent to beanstalk and something unexpected happens. The most common errors
are listed below:</p>

<table>
<tr>
<th>Errors</th>
<th>Description</th>
</tr>
<tr>
<td>Beaneater::NotConnected</td>
<td>Client connection to beanstalk cannot be established.</td>
</tr>
<tr>
<td>Beaneater::InvalidTubeName</td>
<td>Specified tube name for use or watch is not valid.</td>
</tr>
<tr>
<td>Beaneater::NotFoundError</td>
<td>Specified job or tube could not be found.</td>
</tr>
<tr>
<td>Beaneater::TimedOutError</td>
<td>Job could not be reserved within time specified.</td>
</tr>
</table><p>There are other exceptions that are less common such as <code>OutOfMemoryError</code>, <code>DrainingError</code>,
<code>DeadlineSoonError</code>, <code>InternalError</code>, <code>BadFormatError</code>, <code>UnknownCommandError</code>,
<code>ExpectedCRLFError</code>, <code>JobTooBigError</code>, <code>NotIgnoredError</code>. Be sure to check the 
<a href="https://github.com/kr/beanstalkd/blob/master/doc/protocol.md">beanstalk protocol</a> for more information.</p>

<h3>Stats</h3>

<p>Beanstalk has plenty of commands for introspecting the state of the queues and jobs. To get stats for
beanstalk overall:</p>

<div class="highlight"><pre><span class="c1"># Get overall stats about the job processing that has occurred</span>
<span class="nb">print</span> <span class="vi">@beanstalk</span><span class="o">.</span><span class="n">stats</span>
<span class="c1"># =&gt; { 'current_connections': 1, 'current_jobs_buried': 0, 'current_jobs_delayed': 0, ... }</span>
<span class="nb">print</span> <span class="vi">@beanstalk</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">current_connections</span>
<span class="c1"># =&gt; 1</span>
</pre></div>

<p>For stats on a particular tube:</p>

<div class="highlight"><pre><span class="c1"># Get statistical information about the specified tube if it exists</span>
<span class="nb">print</span> <span class="vi">@beanstalk</span><span class="o">.</span><span class="n">tubes</span><span class="o">[</span><span class="s1">'some_tube_name'</span><span class="o">].</span><span class="n">stats</span>
<span class="c1"># =&gt; { 'current_jobs_ready': 0, 'current_jobs_reserved': 0, 'current_jobs_buried': 0, ...  }</span>
</pre></div>

<p>For stats on an individual job:</p>

<div class="highlight"><pre><span class="c1"># Get statistical information about the specified job if it exists</span>
<span class="nb">print</span> <span class="vi">@beanstalk</span><span class="o">.</span><span class="n">jobs</span><span class="o">[</span><span class="n">some_job_id</span><span class="o">].</span><span class="n">stats</span>
<span class="c1"># =&gt; {'age': 0, 'id': 2, 'state': 'reserved', 'tube': 'default', ... }</span>
</pre></div>

<p>Be sure to check the <a href="https://github.com/kr/beanstalkd/blob/master/doc/protocol.md">beanstalk protocol</a> for
more details about the stats commands.</p>

<h2>Resources</h2>

<p>There are other resources helpful when learning about beanstalk:</p>

<ul>
<li><a href="http://kr.github.com/beanstalkd/">Beanstalkd homepage</a></li>
<li><a href="https://github.com/kr/beanstalkd">beanstalk on github</a></li>
<li><a href="https://github.com/kr/beanstalkd/blob/master/doc/protocol.md">beanstalk protocol</a></li>
</ul><h2>Contributors</h2>

<ul>
<li>
<a href="https://github.com/Nico-Taing">Nico Taing</a> - Creator and co-maintainer</li>
<li>
<a href="https://github.com/nesquena">Nathan Esquenazi</a> - Contributor and co-maintainer</li>
</ul>
      </section>
      <footer>
        <p><small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		
  </body>
</html>